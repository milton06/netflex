{% extends 'NetFlexFrontBundle::base_layout.html.twig' %}
{% block pageTitle %}
	{{ parent() }} : {{ pageTitle }}
{% endblock %}
{% block pageStyles %}
	{{ parent() }}
	{% stylesheets 'bundles/netflexdashboard/plugins/bootstrap-modal/css/bootstrap-modal-bs3patch.css'
		'bundles/netflexdashboard/plugins/bootstrap-modal/css/bootstrap-modal.css' filter='cssrewrite' %}
		<link rel="stylesheet" href="{{ asset_url }}">
	{% endstylesheets %}
	<style>
		@media screen {
			#printSection {
				display: none;
			}
		}
		@media print {
			body * {
				visibility:hidden;
			}
			#printSection, #printSection * {
				visibility:visible;
			}
			#printSection {
				position:absolute;
				left:0;
				top:0;
			}
		}
	</style>
{% endblock %}
{% block pageContent %}
	<div class="container">
		<div class="tabform clearfix">
			{% if app.session.flashbag.peek('error') %}
				<div class="alert alert-danger server-message">
					<button data-dismiss="alert" class="close">×</button>
					<i class="fa fa-times-circle"></i>
					{% for error in app.session.flashbag.get('error') %}
						<strong>Oh snap!</strong> {{ error }}.
					{% endfor %}
				</div>
			{% endif %}
			{% if app.session.flashbag.peek('success') %}
				<div class="alert alert-success server-message">
					<button data-dismiss="alert" class="close">×</button>
					<i class="fa fa-check-circle"></i>
					{% for success in app.session.flashbag.get('success') %}
						<strong>Well done!</strong> {{ success }}.
					{% endfor %}
				</div>
			{% endif %}
			<div class="TrackHead clearfix">
				<!--title-->
				<div class="col-lg-6">
					<div class="row">
						<h1><span>Shipment</span> Status</h1>
					</div>
				</div>
				<!--title-->
				<!--button-->
				<div class="col-lg-6">
					<div class="row">
						<ul class="printInvoice">
							<li><a href="#full-width" data-toggle="modal">Print Invoice</a></li>
							<li><a href="{{ url('client_email_invoice', { 'awbNumber': orderDetails.awbNumber }) }}">email Invoice</a></li>
						</ul>
					</div>
				</div>
				<!--button-->
			</div>
			<!--track table-->
			<div class="tracktable clearfix">
				<!--left section-->
				<div class="col-lg-4">
					<div class="row">
						<table width="100%" cellpadding="0" cellspacing="0">
							<tr>
								<td><span>AWB Number :</span></td>
								<td><span>{{ orderDetails.awbNumber }}</span></td>
							</tr>
							<tr>
								<td><span>Order Date :</span></td>
								<td>{{ orderDetails.createdOn|date('j F, Y g:i A') }}</td>
							</tr>
							<tr>
								<td><span>Goods Type :</span></td>
								<td>{{ orderDetails.orderItem.itemPrimaryTypeId.itemTypeName }} > {{ orderDetails.orderItem.itemSecondaryTypeId.itemTypeName }}</td>
							</tr>
							<tr>
								<td><span>Parcel Weight :</span></td>
								<td><span>{{ (orderDetails.orderItem.itemBaseWeight + orderDetails.orderItem.itemAccountableExtraWeight)|number_format(2) }}</span> {{ orderDetails.orderItem.itemWeightUnitId.symbol }}</td>
							</tr>
							<tr>
								<td><span>Risk Type :</span></td>
								<td>{{ ('0.00' == orderDetails.orderPrice.orderCarrierRiskAddedCharge) ? 'Own Risk' : 'Courier Risk' }}</td>
							</tr>
							<tr>
								<td><span>Shipment Type :</span></td>
								<td>{{ orderDetails.deliveryChargeId.deliveryModeTimelineId.deliveryModeId.modeName }}</td>
							</tr>
							<tr>
								<td><span>Payment Option :</span></td>
								<td>{{ ('0.00' == orderDetails.orderPrice.orderCodPaymentAddedCharge) ? 'Non-COD' : 'COD' }}</td>
							</tr>
							<tr>
								<td><span>Shipment Amount :</span></td>
								<td><span>{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ (orderDetails.orderPrice.orderBaseCharge + orderDetails.orderPrice.orderExtraWeightLeviedCharge + orderDetails.orderPrice.orderCodPaymentAddedCharge + orderDetails.orderPrice.orderFuelSurchargeAddedCharge + orderDetails.orderPrice.orderServiceTaxAddedCharge + orderDetails.orderPrice.orderCarrierRiskAddedCharge)|number_format(2) }}</span></td>
							</tr>
						</table>
					</div>
				</div>
				<!--left section-->
				<div class="col-lg-1"><div class="row"></div></div>
				<!--right section-->
				<div class="col-lg-7">
					<div class="row">
						<div class="col-lg-6">
							<div class="row">
								<div class="tblfrom">
									<h2>From</h2>
									<h3>{{ orderDetails.orderAddress.billingFirstName ~ ((orderDetails.orderAddress.billingMidName) ? ' ' ~ orderDetails.orderAddress.billingMidName : ' ' ~ orderDetails.orderAddress.billingLastName) }}</h3>
									<p>
										{{ orderDetails.orderAddress.billingAddressLine1 ~ ((orderDetails.orderAddress.billingAddressLine2) ? ' ' ~ orderDetails.orderAddress.billingAddressLine2 : '') }}<br/>
										{{ orderDetails.orderAddress.billingCityId.name }}, {{ orderDetails.orderAddress.billingStateId.name }} - {{ orderDetails.orderAddress.billingZipCode }}<br/>
										Ph : {{ (orderDetails.orderAddress.billingContactNumber) ? orderDetails.orderAddress.billingContactNumber : 'N/A' }}
									</p>
								</div>
							</div>
						</div>
						<div class="col-lg-6">
							<div class="row">
								<div class="tblto">
									<h2>To</h2>
									<h3>{{ orderDetails.orderAddress.shippingFirstName ~ ((orderDetails.orderAddress.shippingMidName) ? ' ' ~ orderDetails.orderAddress.shippingMidName : ' ' ~ orderDetails.orderAddress.shippingLastName) }}</h3>
									<p>
										{{ orderDetails.orderAddress.shippingAddressLine1 ~ ((orderDetails.orderAddress.shippingAddressLine2) ? ' ' ~ orderDetails.orderAddress.shippingAddressLine2 : '') }}<br/>
										{{ orderDetails.orderAddress.shippingCityId.name }}, {{ orderDetails.orderAddress.shippingStateId.name }} - {{ orderDetails.orderAddress.shippingZipCode }}<br/>
										Ph : {{ orderDetails.orderAddress.shippingContactNumber }}
									</p>
								</div>
							</div>
						</div>
                        <!--track status-->
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="trackstatus">
                                    <ul class="trackHeadline clearfix">
                                        {% for orderTrackStatus in orderTrackStatuses %}
                                            <li class="approve">{{ orderTrackStatus.name|upper }}</li>
                                        {% endfor %}
                                    </ul>
	                                <ul class="trackbar clearfix">
		                                {% for i in 1..orderDetails.orderStatus %}
			                                <li class="approveLine">
				                                <a href="javascript:void(0);" class="redDotOne" data-toggle="tooltip" data-placement="bottom"  title="{{ trackStatusList[i] }}"></a>
			                                </li>
		                                {% endfor %}
	                                </ul>
                                </div>
                            </div>
                        </div>
                        <!--track status-->
					</div>
				</div>
				<!--right section-->
			</div>
			<!--track table-->
		</div>
	</div>
	<div id="full-width" class="modal container fade" tabindex="-1" style="display: none;">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
				&times;
			</button>
			<h4 class="modal-title">Print Invoice</h4>
		</div>
		<div id="printThis" class="modal-body">
			<table style="width: 100%">
				<thead>
				<tr>
					<th colspan="2" style="text-align:center;">
						{% image '@NetFlexFrontBundle/Resources/public/images/netflexLogo.png' %}
							<img src="{{ asset_url }}" alt="Netflex-logo">
						{% endimage %}
					</th>
				</tr>
				</thead>
				<tbody>
				<tr>
					<td>
						<table border="1" cellspacing="2" cellpadding="2" style="width: 100%;">
							<tr>
								<th>AWB Number</th>
								<td>
									{{ orderDetails.awbNumber }}
								</td>
							</tr>
							<tr>
								<th>Order Number</th>
								<td>
									{{ orderDetails.invoiceNumber }}
								</td>
							</tr>
							<tr>
								<th>Order Date</th>
								<td>
									{{ orderDetails.createdOn|date('jS F, Y g:i A') }}
								</td>
							</tr>
							<tr>
								<th>Goods Type</th>
								<td>
									{{ orderDetails.orderItem.itemPrimaryTypeId.itemTypeName() }} > {{ orderDetails.orderItem.itemSecondaryTypeId.itemTypeName() }}
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<table border="1" cellspacing="2" cellpadding="6" style="width: 100%;">
										<thead>
										<tr>
											<th colspan="2">Parcel Weight</th>
										</tr>
										</thead>
										<tbody>
										<tr>
											<th>Base Weight</th>
											<td align="right">{{ orderDetails.orderItem.itemBaseWeight }} {{ orderDetails.orderItem.itemWeightUnitId.symbol }}</td>
										</tr>
										<tr>
											<th>Chargable Extra Weight <small>(above {{ orderDetails.deliveryChargeId.shipmentAccountableExtraWeight }} {{ orderDetails.deliveryChargeId.shipmentWeightUnitId.symbol }})</small></th>
											<td align="right">{{ orderDetails.orderItem.itemAccountableExtraWeight }} {{ orderDetails.orderItem.itemWeightUnitId.symbol }}</td>
										</tr>
										<tr>
											<th>Total</th>
											<td align="right">{{ (orderDetails.orderItem.itemBaseWeight + orderDetails.orderItem.itemAccountableExtraWeight)|number_format(2) }} {{ orderDetails.orderItem.itemWeightUnitId.symbol }}</td>
										</tr>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<th>Risk Type</th>
								<td>
									{{ ('0.00' == orderDetails.orderPrice.orderCarrierRiskAddedCharge) ? 'Own' : 'Carrier' }}
								</td>
							</tr>
							<tr>
								<th>Shipment Type</th>
								<td>
									{{ orderDetails.deliveryChargeId.deliveryModeTimelineId.deliveryModeId.modeName }}
								</td>
							</tr>
							<tr>
								<th>Payment Option</th>
								<td>
									{{ ('0.00' == orderDetails.orderPrice.orderCodPaymentAddedCharge) ? 'Non-COD' : 'COD' }}
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<table border="1" cellspacing="2" cellpadding="2" style="width: 100%;">
										<thead>
										<tr>
											<th colspan="2">Shipment Amount</th>
										</tr>
										</thead>
										<tbody>
										<tr>
											<th>Base Price <small>(for first {{ orderDetails.deliveryChargeId.shipmentBaseWeightUpperLimit }} {{ orderDetails.deliveryChargeId.shipmentWeightUnitId.symbol }})</small></th>
											<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ orderDetails.orderPrice.orderBaseCharge }}</td>
										</tr>
										{% if orderDetails.orderPrice.orderExtraWeightLeviedCharge %}
											<tr>
												<th>Extra Weight Charge <small>({{ orderDetails.deliveryChargeId.deliveryPriceUnitId.currencySymbol }} {{ orderDetails.deliveryChargeId.deliveryExtraPriceMultiplier }} / {{ orderDetails.deliveryChargeId.shipmentAccountableExtraWeight }} {{ orderDetails.deliveryChargeId.shipmentWeightUnitId.symbol }})</small></th>
												<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ orderDetails.orderPrice.orderExtraWeightLeviedCharge }}</td>
											</tr>
										{% endif %}
										{% if '0.00' != orderDetails.orderPrice.orderFuelSurchargeAddedCharge %}
											<tr>
												<th>Added Fuel Surcharge <small>( {{ (orderDetails.deliveryChargeId.fuelSurchargeFixedPrice) ? orderDetails.deliveryChargeId.deliveryPriceUnitId.currencySymbol ~ ' ' ~ orderDetails.deliveryChargeId.fuelSurchargeFixedPrice : orderDetails.deliveryChargeId.fuelSurchargePercentageOnBasePrice ~ '% on base price' }})</small></th>
												<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ orderDetails.orderPrice.orderFuelSurchargeAddedCharge }}</td>
											</tr>
										{% endif %}
										{% if '0.00' != orderDetails.orderPrice.orderServiceTaxAddedCharge %}
											<tr>
												<th>Added Service Tax <small>( {{ orderDetails.deliveryChargeId.serviceTaxPercentageOnBasePrice ~ '% on base price' }})</small></th>
												<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ orderDetails.orderPrice.orderServiceTaxAddedCharge }}</td>
											</tr>
										{% endif %}
										{% if '0.00' != orderDetails.orderPrice.orderCodPaymentAddedCharge %}
											<tr>
												<th>COD Amount <small>( {{ (orderDetails.deliveryChargeId.codDeliveryBasePrice) ? orderDetails.deliveryChargeId.deliveryPriceUnitId.currencySymbol ~ ' ' ~ orderDetails.deliveryChargeId.codDeliveryBasePrice : orderDetails.deliveryChargeId.codDeliveryPercentageOnBasePrice ~ '% on base price' }})</small></th>
												<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ orderDetails.orderPrice.orderCodPaymentAddedCharge }}</td>
											</tr>
										{% endif %}
										{% if '0.00' != orderDetails.orderPrice.orderCarrierRiskAddedCharge %}
											<tr>
												<th>Carrier Risk Charge <small>( {{ orderDetails.deliveryChargeId.shipmentRiskPercentageOnBasePrice ~ '% on base price' }})</small></th>
												<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ orderDetails.orderPrice.orderCarrierRiskAddedCharge }}</td>
											</tr>
										{% endif %}
										<tr>
											<th>Total</th>
											<td class="right">{{ orderDetails.orderPrice.orderPriceUnitId.currencySymbol }} {{ (orderDetails.orderPrice.orderBaseCharge + orderDetails.orderPrice.orderExtraWeightLeviedCharge + orderDetails.orderPrice.orderCodPaymentAddedCharge + orderDetails.orderPrice.orderCarrierRiskAddedCharge + orderDetails.orderPrice.orderFuelSurchargeAddedCharge + orderDetails.orderPrice.orderServiceTaxAddedCharge) }}</td>
										</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</table>
					</td>
					<td valign="top">
						<table border="1" celspacing="2" cellpadding="2" style="width: 100%;">
							<thead>
							<tr>
								<th>From</th>
								<th>To</th>
							</tr>
							</thead>
							<tbody>
							<tr>
								<td>
									<table style="width: 100%;">
										<tr>
											<th>{{ orderDetails.orderAddress.billingFirstName ~ ((orderDetails.orderAddress.billingMidName) ? ' ' ~ orderDetails.orderAddress.billingMidName : '') ~ ' ' ~ orderDetails.orderAddress.billingLastName }}</th>
										</tr>
										<tr>
											<td>{{ orderDetails.orderAddress.billingAddressLine1 ~ ((orderDetails.orderAddress.billingAddressLine2) ? '; ' ~ orderDetails.orderAddress.billingAddressLine2 : '') }}</td>
										</tr>
										<tr>
											<td>{{ orderDetails.orderAddress.billingCityId.name ~ ', ' ~ orderDetails.orderAddress.billingStateId.name ~ ' - ' ~ orderDetails.orderAddress.billingZipCode }}</td>
										</tr>
										<tr>
											<td>Ph: {{ orderDetails.orderAddress.billingContactNumber }}</td>
										</tr>
									</table>
								</td>
								<td>
									<table style="width: 100%;">
										<tr>
											<th>{{ orderDetails.orderAddress.shippingFirstName ~ ((orderDetails.orderAddress.shippingMidName) ? ' ' ~ orderDetails.orderAddress.shippingMidName : '') ~ ' ' ~ orderDetails.orderAddress.shippingLastName }}</th>
										</tr>
										<tr>
											<td>{{ orderDetails.orderAddress.shippingAddressLine1 ~ ((orderDetails.orderAddress.shippingAddressLine2) ? '; ' ~ orderDetails.orderAddress.shippingAddressLine2 : '') }}</td>
										</tr>
										<tr>
											<td>{{ orderDetails.orderAddress.shippingCityId.name ~ ', ' ~ orderDetails.orderAddress.shippingStateId.name ~ ' - ' ~ orderDetails.orderAddress.shippingZipCode }}</td>
										</tr>
										<tr>
											<td>Ph: {{ orderDetails.orderAddress.shippingContactNumber }}</td>
										</tr>
									</table>
								</td>
							</tr>
							</tbody>
						</table>
					</td>
				</tr>
				</tbody>
			</table>
		</div>
		<div class="modal-footer">
			<button type="button" id="print-button" class="btn btn-primary">
				<i class="fa fa-print"></i> Print
			</button>
			<button type="button" data-dismiss="modal" class="btn btn-primary">
				<i class="fa fa-times"></i> Cancel
			</button>
		</div>
	</div>
	{% block footer %}
		{{ include('NetFlexFrontBundle:LayoutPartial:footer.html.twig') }}
	{% endblock %}
{% endblock %}
{% block pageScripts %}
	{{ parent() }}
	{% javascripts '@NetFlexDashboardBundle/Resources/public/plugins/bootstrap-modal/js/bootstrap-modal.js'
		'@NetFlexDashboardBundle/Resources/public/plugins/bootstrap-modal/js/bootstrap-modalmanager.js' %}
		<script src="{{ asset_url }}"></script>
	{% endjavascripts %}
	<script>
		function printElement(elem) {
			var domClone = elem.cloneNode(true);

			var $printSection = document.getElementById("printSection");

			if (!$printSection) {
				var $printSection = document.createElement("div");
				$printSection.id = "printSection";
				document.body.appendChild($printSection);
			}

			$printSection.innerHTML = "";
			$printSection.appendChild(domClone);
			window.print();
		}

		jQuery("#print-button").click(function(e) {
			printElement(document.getElementById("printThis"));
		});
	</script>
{% endblock %}